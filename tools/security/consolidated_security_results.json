{
  "audit_time": "2026-02-09T00:30:38.539110",
  "repository": "/home/Memo1981/MyWork-AI",
  "api_url": "https://mywork-ai-production.up.railway.app",
  "risk_score": 3.38,
  "risk_level": "MEDIUM",
  "total_findings": 87,
  "findings_by_category": {
    "code": [
      {
        "severity": "MEDIUM",
        "file": "tools/auto_lint_fixer.py",
        "line": 744,
        "description": "Insecure HTTP URL - should use HTTPS",
        "code_snippet": "fixes_applied[\"MD034\"] = content.count(\"http://\") + content.count(\"https://\")"
      },
      {
        "severity": "MEDIUM",
        "file": "tools/auto_lint_fixer.py",
        "line": 744,
        "description": "Hardcoded HTTP URL",
        "code_snippet": "fixes_applied[\"MD034\"] = content.count(\"http://\") + content.count(\"https://\")"
      },
      {
        "severity": "HIGH",
        "file": "tools/autoforge_api.py",
        "line": 193,
        "description": "Use of popen() - command injection risk",
        "code_snippet": "subprocess.Popen("
      },
      {
        "severity": "LOW",
        "file": "tools/auto_update.py",
        "line": 522,
        "description": "Print statement with key",
        "code_snippet": "print(f\"Available: {', '.join(COMPONENTS.keys())}, all\")"
      },
      {
        "severity": "LOW",
        "file": "tools/switch_llm_provider.py",
        "line": 160,
        "description": "Print statement with key",
        "code_snippet": "print(f\"\u26a0\ufe0f  Warning: {env_key} not found in environment\")"
      },
      {
        "severity": "LOW",
        "file": "tools/switch_llm_provider.py",
        "line": 173,
        "description": "Print statement with key",
        "code_snippet": "print(f\"Available: {', '.join(PROVIDERS.keys())}\")"
      },
      {
        "severity": "LOW",
        "file": "tools/switch_llm_provider.py",
        "line": 188,
        "description": "Print statement with key",
        "code_snippet": "print(f\"\u274c Cannot switch - missing API key\")"
      },
      {
        "severity": "LOW",
        "file": "tools/switch_llm_provider.py",
        "line": 242,
        "description": "Print statement with key",
        "code_snippet": "print(f\"  {status} {key:12} - {info['name']}\")"
      },
      {
        "severity": "LOW",
        "file": "tools/scaffold.py",
        "line": 414,
        "description": "Print statement with key",
        "code_snippet": "print(f\"   Available: {', '.join(TEMPLATES.keys())}\")"
      },
      {
        "severity": "HIGH",
        "file": "tools/autocoder_api.py",
        "line": 193,
        "description": "Use of popen() - command injection risk",
        "code_snippet": "subprocess.Popen("
      },
      {
        "severity": "HIGH",
        "file": "tools/health_check.py",
        "line": 1153,
        "description": "subprocess with shell=True - command injection risk",
        "code_snippet": "subprocess.run(result.fix_command, shell=True)"
      },
      {
        "severity": "CRITICAL",
        "file": "tools/brain_learner.py",
        "line": 386,
        "description": "Potential hardcoded API key or token",
        "code_snippet": "(r\"ConnectionRefusedError\", \"Connection refused - check if service is running\"),"
      },
      {
        "severity": "LOW",
        "file": "tools/marketplace_upload_previews.py",
        "line": 105,
        "description": "Print statement with key",
        "code_snippet": "print(f\"Uploaded {image.name} -> {file_key}\")"
      },
      {
        "severity": "LOW",
        "file": "tools/brain_search.py",
        "line": 372,
        "description": "Print statement with key",
        "code_snippet": "print(f\"\u274c Invalid type. Valid: {', '.join(ENTRY_TYPES.keys())}\")"
      },
      {
        "severity": "LOW",
        "file": "tools/project_registry.py",
        "line": 269,
        "description": "Print statement with key",
        "code_snippet": "print(f\"  - {key}: {by_type[key]}\")"
      },
      {
        "severity": "LOW",
        "file": "tools/project_registry.py",
        "line": 272,
        "description": "Print statement with key",
        "code_snippet": "print(f\"  - {key}: {by_status[key]}\")"
      },
      {
        "severity": "HIGH",
        "file": "tools/lint_watcher.py",
        "line": 64,
        "description": "Use of popen() - command injection risk",
        "code_snippet": "process = subprocess.Popen("
      },
      {
        "severity": "LOW",
        "file": "tools/brain.py",
        "line": 377,
        "description": "Print statement with key",
        "code_snippet": "print(f\"Types: {', '.join(ENTRY_TYPES.keys())}\")"
      },
      {
        "severity": "LOW",
        "file": "projects/ai-dashboard/backend/scripts/youtube_upload_smoke.py",
        "line": 79,
        "description": "Print statement with key",
        "code_snippet": "print(f\"   - {key}\")"
      },
      {
        "severity": "CRITICAL",
        "file": "projects/ai-dashboard/backend/services/youtube_automation.py",
        "line": 207,
        "description": "Potential hardcoded API key or token",
        "code_snippet": "voice_id: str = \"1bd001e7e50f421d891986aad5158bc8\","
      },
      {
        "severity": "LOW",
        "file": "tools/e2e/test_marketplace_e2e.py",
        "line": 70,
        "description": "Print statement with key",
        "code_snippet": "print(f\"  {key}: {value}\")"
      },
      {
        "severity": "MEDIUM",
        "file": "tools/security/api_tester.py",
        "line": 193,
        "description": "Insecure HTTP URL - should use HTTPS",
        "code_snippet": "'http://evil.com',"
      },
      {
        "severity": "MEDIUM",
        "file": "tools/security/api_tester.py",
        "line": 193,
        "description": "Hardcoded HTTP URL",
        "code_snippet": "'http://evil.com',"
      },
      {
        "severity": "MEDIUM",
        "file": "tools/security/api_tester.py",
        "line": 337,
        "description": "Insecure HTTP URL - should use HTTPS",
        "code_snippet": "http_url = self.base_url.replace('https://', 'http://')"
      },
      {
        "severity": "MEDIUM",
        "file": "tools/security/api_tester.py",
        "line": 337,
        "description": "Hardcoded HTTP URL",
        "code_snippet": "http_url = self.base_url.replace('https://', 'http://')"
      },
      {
        "severity": "CRITICAL",
        "file": "tools/security/code_scanner.py",
        "line": 56,
        "description": "Use of eval() function - code injection risk",
        "code_snippet": "(r'\\beval\\s*\\(', 'Use of eval() function - code injection risk'),"
      },
      {
        "severity": "CRITICAL",
        "file": "tools/security/code_scanner.py",
        "line": 57,
        "description": "Use of exec() function - code injection risk",
        "code_snippet": "(r'\\bexec\\s*\\(', 'Use of exec() function - code injection risk'),"
      },
      {
        "severity": "HIGH",
        "file": "tools/security/code_scanner.py",
        "line": 64,
        "description": "Use of os.system() - command injection risk",
        "code_snippet": "(r'os\\.system\\s*\\(', 'Use of os.system() - command injection risk'),"
      },
      {
        "severity": "HIGH",
        "file": "tools/security/code_scanner.py",
        "line": 65,
        "description": "subprocess with shell=True - command injection risk",
        "code_snippet": "(r'subprocess.*shell\\s*=\\s*True', 'subprocess with shell=True - command injection risk'),"
      },
      {
        "severity": "HIGH",
        "file": "tools/security/code_scanner.py",
        "line": 66,
        "description": "Use of popen() - command injection risk",
        "code_snippet": "(r'popen\\s*\\(', 'Use of popen() - command injection risk'),"
      },
      {
        "severity": "HIGH",
        "file": "tools/security/code_scanner.py",
        "line": 72,
        "description": "String formatting in SQL query - SQL injection risk",
        "code_snippet": "(r'[\"\\'].*%.*[\"\\'].*%', 'String formatting in SQL query - SQL injection risk'),"
      },
      {
        "severity": "HIGH",
        "file": "tools/security/code_scanner.py",
        "line": 73,
        "description": "String concatenation in SQL query",
        "code_snippet": "(r'[\"\\'].*\\+.*[\"\\'].*cursor', 'String concatenation in SQL query'),"
      },
      {
        "severity": "MEDIUM",
        "file": "tools/security/code_scanner.py",
        "line": 89,
        "description": "Insecure HTTP URL - should use HTTPS",
        "code_snippet": "(r'http://[^/\\s]+', 'Insecure HTTP URL - should use HTTPS'),"
      },
      {
        "severity": "MEDIUM",
        "file": "tools/security/code_scanner.py",
        "line": 89,
        "description": "Hardcoded HTTP URL",
        "code_snippet": "(r'http://[^/\\s]+', 'Insecure HTTP URL - should use HTTPS'),"
      },
      {
        "severity": "MEDIUM",
        "file": "tools/security/code_scanner.py",
        "line": 90,
        "description": "Insecure HTTP URL - should use HTTPS",
        "code_snippet": "(r'[\"\\']http://.*[\"\\']', 'Hardcoded HTTP URL'),"
      },
      {
        "severity": "LOW",
        "file": "tools/security/code_scanner.py",
        "line": 100,
        "description": "Logger statement with password",
        "code_snippet": "(r'logger.*password', 'Logger statement with password'),"
      },
      {
        "severity": "LOW",
        "file": "tools/security/code_scanner.py",
        "line": 101,
        "description": "Logger statement with secret",
        "code_snippet": "(r'logger.*secret', 'Logger statement with secret'),"
      },
      {
        "severity": "HIGH",
        "file": "tools/security/code_scanner.py",
        "line": 229,
        "description": "Use of popen() - command injection risk",
        "code_snippet": "'scan_time': os.popen('date -Iseconds').read().strip(),"
      },
      {
        "severity": "HIGH",
        "file": "tools/security/dep_audit.py",
        "line": 311,
        "description": "Use of popen() - command injection risk",
        "code_snippet": "'audit_time': os.popen('date -Iseconds').read().strip(),"
      },
      {
        "severity": "HIGH",
        "file": "tools/security/infra_scanner.py",
        "line": 411,
        "description": "Use of popen() - command injection risk",
        "code_snippet": "'scan_time': os.popen('date -Iseconds').read().strip(),"
      },
      {
        "severity": "LOW",
        "file": "tools/simulation/mlm_simulator.py",
        "line": 598,
        "description": "Print statement with key",
        "code_snippet": "print(f\"   {key.replace('_', ' ').title()}: {value}\")"
      },
      {
        "severity": "LOW",
        "file": "tools/simulation/mlm_simulator.py",
        "line": 602,
        "description": "Print statement with key",
        "code_snippet": "print(f\"   {key.replace('_', ' ').title()}: {value}\")"
      },
      {
        "severity": "LOW",
        "file": "tools/simulation/credit_engine.py",
        "line": 612,
        "description": "Print statement with key",
        "code_snippet": "print(f\"   {key.replace('_', ' ').title()}: {value}\")"
      },
      {
        "severity": "LOW",
        "file": "tools/simulation/credit_engine.py",
        "line": 616,
        "description": "Print statement with key",
        "code_snippet": "print(f\"   {key.replace('_', ' ').title()}: {value}\")"
      },
      {
        "severity": "LOW",
        "file": "tools/simulation/credit_engine.py",
        "line": 620,
        "description": "Print statement with key",
        "code_snippet": "print(f\"   {key.replace('_', ' ').title()}: {value}\")"
      }
    ],
    "dependencies": [
      {
        "package": "fastapi",
        "version": "0.109.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 0.128.5)",
        "recommendation": "Consider updating to 0.128.5"
      },
      {
        "package": "apscheduler",
        "version": "3.10.4",
        "severity": "LOW",
        "issue": "Outdated version (latest: 3.11.2)",
        "recommendation": "Consider updating to 3.11.2"
      },
      {
        "package": "httpx",
        "version": "0.25.1",
        "severity": "LOW",
        "issue": "Outdated version (latest: 0.28.1)",
        "recommendation": "Consider updating to 0.28.1"
      },
      {
        "package": "google-auth-oauthlib",
        "version": "1.2.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 1.2.4)",
        "recommendation": "Consider updating to 1.2.4"
      },
      {
        "package": "httpx",
        "version": "0.25.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 0.28.1)",
        "recommendation": "Consider updating to 0.28.1"
      },
      {
        "package": "requests",
        "version": "2.31.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 2.32.5)",
        "recommendation": "Consider updating to 2.32.5"
      },
      {
        "package": "pyyaml",
        "version": "6.0.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 6.0.3)",
        "recommendation": "Consider updating to 6.0.3"
      },
      {
        "package": "google-api-python-client",
        "version": "2.118.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 2.189.0)",
        "recommendation": "Consider updating to 2.189.0"
      },
      {
        "package": "rich",
        "version": "13.0.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 14.3.2)",
        "recommendation": "Consider updating to 14.3.2"
      },
      {
        "package": "dspy-ai",
        "version": "2.4.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 3.1.3)",
        "recommendation": "Consider updating to 3.1.3"
      },
      {
        "package": "aiosqlite",
        "version": "0.19.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 0.22.1)",
        "recommendation": "Consider updating to 0.22.1"
      },
      {
        "package": "anthropic",
        "version": "0.18.1",
        "severity": "LOW",
        "issue": "Outdated version (latest: 0.79.0)",
        "recommendation": "Consider updating to 0.79.0"
      },
      {
        "package": "python-dateutil",
        "version": "2.8.2",
        "severity": "LOW",
        "issue": "Outdated version (latest: 2.9.0.post0)",
        "recommendation": "Consider updating to 2.9.0.post0"
      },
      {
        "package": "feedparser",
        "version": "6.0.10",
        "severity": "LOW",
        "issue": "Outdated version (latest: 6.0.12)",
        "recommendation": "Consider updating to 6.0.12"
      },
      {
        "package": "sqlalchemy",
        "version": "2.0.25",
        "severity": "LOW",
        "issue": "Outdated version (latest: 2.0.46)",
        "recommendation": "Consider updating to 2.0.46"
      },
      {
        "package": "python-dotenv",
        "version": "1.0.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 1.2.1)",
        "recommendation": "Consider updating to 1.2.1"
      },
      {
        "package": "click",
        "version": "8.1.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 8.3.1)",
        "recommendation": "Consider updating to 8.3.1"
      },
      {
        "package": "apify-client",
        "version": "1.6.0",
        "severity": "LOW",
        "issue": "Outdated version (latest: 2.4.1)",
        "recommendation": "Consider updating to 2.4.1"
      }
    ],
    "api": [
      {
        "endpoint": "/api/products",
        "method": "GET",
        "severity": "HIGH",
        "issue": "Information disclosure - sensitive data in response",
        "details": "Response contains sensitive keywords: https://mywork-ai-production.up.railway.app/api/products"
      },
      {
        "endpoint": "/openapi.json",
        "method": "GET",
        "severity": "HIGH",
        "issue": "Information disclosure - sensitive data in response",
        "details": "Response contains sensitive keywords: https://mywork-ai-production.up.railway.app/openapi.json"
      },
      {
        "endpoint": "/openapi.json",
        "method": "GET",
        "severity": "MEDIUM",
        "issue": "Information disclosure - debug information in response",
        "details": "Response contains debug information: https://mywork-ai-production.up.railway.app/openapi.json"
      },
      {
        "endpoint": "/",
        "method": "GET",
        "severity": "MEDIUM",
        "issue": "Missing X-Frame-Options header - clickjacking vulnerability",
        "details": "Header 'X-Frame-Options' not found in response"
      },
      {
        "endpoint": "/",
        "method": "GET",
        "severity": "MEDIUM",
        "issue": "Missing X-Content-Type-Options header - MIME sniffing vulnerability",
        "details": "Header 'X-Content-Type-Options' not found in response"
      },
      {
        "endpoint": "/",
        "method": "GET",
        "severity": "MEDIUM",
        "issue": "Missing Content-Security-Policy header - XSS vulnerability",
        "details": "Header 'Content-Security-Policy' not found in response"
      },
      {
        "endpoint": "/",
        "method": "GET",
        "severity": "MEDIUM",
        "issue": "Missing HSTS header - insecure transport",
        "details": "Header 'Strict-Transport-Security' not found in response"
      },
      {
        "endpoint": "/",
        "method": "GET",
        "severity": "MEDIUM",
        "issue": "Missing X-XSS-Protection header - XSS vulnerability",
        "details": "Header 'X-XSS-Protection' not found in response"
      },
      {
        "endpoint": "/",
        "method": "GET",
        "severity": "MEDIUM",
        "issue": "Missing Referrer-Policy header - information disclosure",
        "details": "Header 'Referrer-Policy' not found in response"
      },
      {
        "endpoint": "/",
        "method": "GET",
        "severity": "LOW",
        "issue": "Information disclosure in Server header",
        "details": "Header 'Server' reveals server information: railway-edge"
      },
      {
        "endpoint": "/",
        "method": "GET",
        "severity": "MEDIUM",
        "issue": "No rate limiting detected",
        "details": "Made 20 requests in 4.62s with no rate limiting"
      },
      {
        "endpoint": "/",
        "method": "GET",
        "severity": "MEDIUM",
        "issue": "HTTP endpoint does not redirect to HTTPS",
        "details": "HTTP version accessible at: http://mywork-ai-production.up.railway.app"
      }
    ],
    "infrastructure": [
      {
        "category": "Network",
        "severity": "MEDIUM",
        "issue": "Port 22: SSH exposed to all interfaces",
        "details": "Port 22 is listening and may pose a security risk",
        "recommendation": "Review if this port needs to be publicly accessible"
      },
      {
        "category": "File Permissions",
        "severity": "HIGH",
        "issue": "Sensitive file is world-readable: .env.example",
        "details": "File permissions: 664",
        "recommendation": "Remove world-read permissions (chmod o-r)"
      },
      {
        "category": "File Permissions",
        "severity": "HIGH",
        "issue": "Sensitive file is world-readable: projects/ai-dashboard/backend/.env.example",
        "details": "File permissions: 664",
        "recommendation": "Remove world-read permissions (chmod o-r)"
      },
      {
        "category": "File Permissions",
        "severity": "HIGH",
        "issue": "Sensitive file is world-readable: projects/ai-dashboard/frontend/.env.production",
        "details": "File permissions: 664",
        "recommendation": "Remove world-read permissions (chmod o-r)"
      },
      {
        "category": "File Permissions",
        "severity": "HIGH",
        "issue": "Sensitive file is world-readable: projects/ai-dashboard/frontend/.env.example",
        "details": "File permissions: 664",
        "recommendation": "Remove world-read permissions (chmod o-r)"
      },
      {
        "category": "SSH Configuration",
        "severity": "HIGH",
        "issue": "Root login permitted",
        "details": "Found in /etc/ssh/sshd_config",
        "recommendation": "Review SSH configuration for security best practices"
      },
      {
        "category": "SSH Configuration",
        "severity": "LOW",
        "issue": "X11 forwarding enabled",
        "details": "Found in /etc/ssh/sshd_config",
        "recommendation": "Review SSH configuration for security best practices"
      },
      {
        "category": "Environment Variables",
        "severity": "LOW",
        "issue": "Sensitive environment variable detected: ANTHROPIC_API_KEY",
        "details": "Environment variable name suggests sensitive content",
        "recommendation": "Ensure sensitive env vars are properly secured"
      },
      {
        "category": "Environment Variables",
        "severity": "LOW",
        "issue": "Sensitive environment variable detected: SUPABASE_SERVICE_ROLE_KEY",
        "details": "Environment variable name suggests sensitive content",
        "recommendation": "Ensure sensitive env vars are properly secured"
      },
      {
        "category": "Environment Variables",
        "severity": "LOW",
        "issue": "Sensitive environment variable detected: ZAI_API_KEY",
        "details": "Environment variable name suggests sensitive content",
        "recommendation": "Ensure sensitive env vars are properly secured"
      },
      {
        "category": "Environment Variables",
        "severity": "LOW",
        "issue": "Sensitive environment variable detected: GOOGLE_API_KEY",
        "details": "Environment variable name suggests sensitive content",
        "recommendation": "Ensure sensitive env vars are properly secured"
      },
      {
        "category": "Environment Variables",
        "severity": "LOW",
        "issue": "Sensitive environment variable detected: OPENROUTER_API_KEY",
        "details": "Environment variable name suggests sensitive content",
        "recommendation": "Ensure sensitive env vars are properly secured"
      }
    ]
  }
}