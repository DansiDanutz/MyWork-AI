<project_specification>
  <project_name>MyWork Marketplace</project_name>

  <overview>
    An AI-powered development marketplace where developers can sell their production-ready projects,
    SaaS templates, and code packages. Sellers keep 90% of each sale. The platform includes a
    collective "Brain" knowledge system powered by AI.
  </overview>

  <technology_stack>
    <frontend>
      <framework>Next.js 14 (App Router)</framework>
      <styling>Tailwind CSS</styling>
      <auth>Clerk</auth>
      <components>shadcn/ui style components</components>
    </frontend>
    <backend>
      <runtime>Python 3.11+ with FastAPI</runtime>
      <database>SQLite (development) / PostgreSQL (production)</database>
      <orm>SQLAlchemy with async support</orm>
      <auth>Clerk JWT verification</auth>
    </backend>
    <communication>
      <api>REST API</api>
      <payments>Stripe Connect</payments>
      <storage>Cloudflare R2</storage>
    </communication>
  </technology_stack>

  <existing_code>
    The project already has foundational code in place:

    BACKEND (backend/):
    - main.py: FastAPI app with all routers mounted
    - config.py: Settings management
    - database.py: Async SQLAlchemy setup
    - auth.py: Clerk JWT middleware
    - models/: All database models (User, Product, Order, Review, Payout, Subscription, BrainEntry)
    - api/: All API routers (products, users, orders, reviews, brain, webhooks)
    - alembic/: Database migrations

    FRONTEND (frontend/):
    - app/layout.tsx: Root layout with Clerk provider and navbar
    - app/page.tsx: Landing page (hero, features, stats)
    - app/products/page.tsx: Product browse page
    - app/products/[slug]/page.tsx: Product detail page
    - app/pricing/page.tsx: Pricing plans page
    - app/(dashboard)/layout.tsx: Dashboard layout with sidebar
    - app/(dashboard)/dashboard/page.tsx: Dashboard overview with mock data
    - components/ui/: Button, Card, Input, Badge, Avatar components
    - lib/api.ts: API client (needs real integration)

    DO NOT recreate these files. Build upon and extend them.
  </existing_code>

  <feature_count>45</feature_count>

  <core_features>
    <dashboard_products>
      - Products list page showing seller's products with stats
      - Product creation form with multi-step wizard
      - Product edit page
      - Product delete with confirmation
      - Product visibility toggle (draft/published)
      - Product analytics per product
    </dashboard_products>

    <dashboard_orders>
      - Orders list page showing sales
      - Order detail view
      - Order status tracking
      - Download link management
      - Refund request handling
    </dashboard_orders>

    <dashboard_payouts>
      - Payouts list with history
      - Pending balance display
      - Payout request form
      - Stripe Connect onboarding flow
      - Payout status tracking
    </dashboard_payouts>

    <dashboard_analytics>
      - Revenue chart (daily/weekly/monthly)
      - Sales count chart
      - Top products list
      - Traffic sources
      - Conversion rate
    </dashboard_analytics>

    <dashboard_brain>
      - Brain contributions list
      - Create knowledge entry form
      - Edit knowledge entry
      - Usage stats per entry
      - Categories and tags management
    </dashboard_brain>

    <dashboard_settings>
      - Profile settings form
      - Seller profile settings
      - Notification preferences
      - Connected accounts (Stripe)
      - Account deletion
    </dashboard_settings>

    <api_integration>
      - Connect dashboard to real backend APIs
      - Replace all mock data with API calls
      - Add loading states and error handling
      - Implement optimistic updates
      - Add request caching
    </api_integration>

    <file_upload>
      - Product image upload to R2
      - Product package file upload
      - Preview image gallery
      - File validation (type, size)
      - Upload progress indicator
    </file_upload>

    <checkout_flow>
      - Add to cart functionality
      - Checkout page with Stripe
      - License selection (standard/extended)
      - Order confirmation page
      - Purchase receipt email
    </checkout_flow>

    <search_and_filter>
      - Full-text product search
      - Category filter
      - Price range filter
      - Tech stack filter
      - Sort by (newest, popular, price)
    </search_and_filter>
  </core_features>

  <database_schema>
    <note>Schema already exists in backend/models/. Do not recreate.</note>
    <tables>
      <users>id, clerk_id, email, username, display_name, avatar_url, role, is_seller, etc.</users>
      <seller_profiles>id, user_id, display_name, bio, stripe_account_id, payouts_enabled, etc.</seller_profiles>
      <products>id, seller_id, name, slug, description, price, status, category, tech_stack, etc.</products>
      <orders>id, buyer_id, seller_id, product_id, amount, payment_status, download_url, etc.</orders>
      <reviews>id, order_id, reviewer_id, product_id, rating, title, content, etc.</reviews>
      <payouts>id, seller_id, amount, status, stripe_transfer_id, etc.</payouts>
      <brain_entries>id, contributor_id, entry_type, title, content, tags, etc.</brain_entries>
    </tables>
  </database_schema>

  <api_endpoints_summary>
    <note>Endpoints already exist in backend/api/. Connect frontend to these.</note>
    <products>
      - GET /api/products - List products (public)
      - GET /api/products/{slug} - Get product detail
      - POST /api/products - Create product (auth)
      - PUT /api/products/{id} - Update product (auth)
      - DELETE /api/products/{id} - Delete product (auth)
      - GET /api/products/me - Get seller's products (auth)
    </products>
    <users>
      - GET /api/users/me - Get current user
      - PUT /api/users/me - Update profile
      - POST /api/users/become-seller - Become a seller
      - GET /api/users/me/seller-profile - Get seller profile
    </users>
    <orders>
      - GET /api/orders - Get user's orders
      - POST /api/orders - Create order (checkout)
      - GET /api/orders/{id} - Get order detail
      - GET /api/orders/{id}/download - Get download URL
    </orders>
    <reviews>
      - GET /api/reviews/product/{product_id} - Get product reviews
      - POST /api/reviews - Create review
    </reviews>
    <brain>
      - GET /api/brain - List entries
      - POST /api/brain - Create entry
      - GET /api/brain/query - Query brain with AI
    </brain>
  </api_endpoints_summary>

  <ui_layout>
    <main_structure>
      Existing layout with header (logo, nav, auth buttons).
      Dashboard has sidebar navigation with: Overview, Products, Orders, Payouts, Analytics, Brain, Settings.
    </main_structure>
    <pages_to_create>
      - /dashboard/products (list)
      - /dashboard/products/new (create form)
      - /dashboard/products/[id]/edit (edit form)
      - /dashboard/orders (list)
      - /dashboard/orders/[id] (detail)
      - /dashboard/payouts (list + request)
      - /dashboard/analytics (charts)
      - /dashboard/brain (contributions)
      - /dashboard/brain/new (create entry)
      - /dashboard/settings (form)
      - /checkout/[productId] (checkout flow)
      - /checkout/success (confirmation)
    </pages_to_create>
  </ui_layout>

  <design_system>
    <color_palette>
      Dark theme: gray-900 background, gray-800 cards, blue-600 primary, green-500 success, red-500 error
    </color_palette>
    <typography>
      Inter font, white headings, gray-300/400 body text
    </typography>
  </design_system>

  <implementation_steps>
    <step number="1">
      <title>Dashboard Product Pages</title>
      <tasks>
        - Create /dashboard/products page listing seller's products
        - Create /dashboard/products/new with multi-step form
        - Create /dashboard/products/[id]/edit for editing
        - Add product delete functionality
        - Connect to backend API
      </tasks>
    </step>
    <step number="2">
      <title>Dashboard Orders & Payouts</title>
      <tasks>
        - Create /dashboard/orders page
        - Create /dashboard/orders/[id] detail page
        - Create /dashboard/payouts page
        - Add Stripe Connect onboarding button
        - Display payout history and pending balance
      </tasks>
    </step>
    <step number="3">
      <title>Analytics & Brain</title>
      <tasks>
        - Create /dashboard/analytics with charts
        - Create /dashboard/brain contributions list
        - Create /dashboard/brain/new entry form
        - Add usage stats display
      </tasks>
    </step>
    <step number="4">
      <title>Settings & File Upload</title>
      <tasks>
        - Create /dashboard/settings page
        - Implement file upload component
        - Add image upload to product form
        - Add package file upload
      </tasks>
    </step>
    <step number="5">
      <title>Checkout Flow</title>
      <tasks>
        - Create /checkout/[productId] page
        - Integrate Stripe payment
        - Create /checkout/success page
        - Send confirmation email
      </tasks>
    </step>
    <step number="6">
      <title>Search & Filters</title>
      <tasks>
        - Add search input to products page
        - Add category filter sidebar
        - Add price range slider
        - Add sort dropdown
        - Implement URL-based filtering
      </tasks>
    </step>
  </implementation_steps>

  <success_criteria>
    <functionality>
      - User can sign up, sign in, view products
      - Seller can create, edit, delete products
      - Seller can view orders and request payouts
      - Buyer can search, filter, and purchase products
      - Brain contributions work end-to-end
    </functionality>
    <user_experience>
      - All pages load without errors
      - Loading states shown during API calls
      - Error messages displayed appropriately
      - Responsive on mobile and desktop
    </user_experience>
    <technical_quality>
      - No TypeScript errors
      - All API calls handle errors
      - Forms validate input
      - State management is clean
    </technical_quality>
  </success_criteria>
</project_specification>
