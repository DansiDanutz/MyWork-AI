---
phase: 07-performance-quality
plan: 03
type: execute
wave: 2
depends_on: [07-01, 07-02]
files_modified:

  - src/shared/components/SwipeableTaskCard.tsx
  - src/shared/components/TaskCard.tsx
  - src/shared/components/TaskList.tsx
  - src/app/(app)/layout.tsx
  - src/shared/components/MobileNav.tsx
  - package.json

autonomous: true

must_haves:
  truths:

    - "Tasks can be swiped on mobile to complete or delete"
    - "Navigation collapses to hamburger menu on mobile"
    - "All touch targets are at least 44x44px"
    - "Swipe gestures work smoothly without blocking scroll"

  artifacts:

    - path: "src/shared/components/SwipeableTaskCard.tsx"

      provides: "Mobile-friendly task card with swipe gestures"
      exports: ["SwipeableTaskCard"]

    - path: "src/shared/components/MobileNav.tsx"

      provides: "Mobile hamburger navigation"
      exports: ["MobileNav"]

    - path: "package.json"

      provides: "react-swipeable dependency"
      contains: "react-swipeable"
  key_links:

    - from: "src/shared/components/TaskList.tsx"

      to: "src/shared/components/SwipeableTaskCard.tsx"
      via: "conditional render"
      pattern: "SwipeableTaskCard"
---

<objective>
Implement mobile responsiveness with swipe gestures and collapsing navigation

Purpose: Create a native-feeling mobile experience with swipe gestures for task management (swipe right to complete, swipe left to delete) and responsive navigation that collapses to a hamburger menu on small screens.

Output: SwipeableTaskCard component with react-swipeable, responsive navigation with mobile hamburger menu
</objective>

<execution_context>
@/Users/dansidanutz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dansidanutz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-performance-quality/07-CONTEXT.md
@.planning/phases/07-performance-quality/07-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install react-swipeable and create SwipeableTaskCard</name>
  <files>
    package.json
    src/shared/components/SwipeableTaskCard.tsx
  </files>
  <action>

1. Install react-swipeable:

```bash
npm install react-swipeable

```

2. Create `SwipeableTaskCard.tsx`:

```tsx
'use client'

import { useState, useCallback } from 'react'
import { useSwipeable } from 'react-swipeable'
import { TaskCard } from './TaskCard'
import { updateTaskStatus, deleteTask } from '@/app/actions/tasks'

type Task = {
  id: string
  title: string
  description: string | null
  status: 'TODO' | 'IN_PROGRESS' | 'DONE'
  createdAt: Date
  updatedAt: Date
  tags?: { id: string; name: string; color: string | null }[]
  attachments?: { id: string }[]
}

type SwipeableTaskCardProps = {
  task: Task
}

export function SwipeableTaskCard({ task }: SwipeableTaskCardProps) {
  const [swipeOffset, setSwipeOffset] = useState(0)
  const [isProcessing, setIsProcessing] = useState(false)
  const [swipeDirection, setSwipeDirection] = useState<'left' | 'right' | null>(null)

  const handleComplete = useCallback(async () => {
    if (task.status === 'DONE' || isProcessing) return
    setIsProcessing(true)
    const result = await updateTaskStatus(task.id, 'DONE')
    if (!result.success) {
      alert(`Failed to complete task: ${result.error}`)
    }
    setIsProcessing(false)
    setSwipeOffset(0)
  }, [task.id, task.status, isProcessing])

  const handleDelete = useCallback(async () => {
    if (isProcessing) return
    if (!confirm('Delete this task?')) {
      setSwipeOffset(0)
      return
    }
    setIsProcessing(true)
    const result = await deleteTask(task.id)
    if (!result.success) {
      alert(`Failed to delete task: ${result.error}`)
      setIsProcessing(false)
      setSwipeOffset(0)
    }
  }, [task.id, isProcessing])

  const handlers = useSwipeable({
    onSwiping: (eventData) => {
      // Only track horizontal swipes
      if (Math.abs(eventData.deltaX) > Math.abs(eventData.deltaY)) {
        setSwipeOffset(eventData.deltaX)
        setSwipeDirection(eventData.deltaX > 0 ? 'right' : 'left')
      }
    },
    onSwipedRight: () => {
      if (Math.abs(swipeOffset) > 100) {
        handleComplete()
      } else {
        setSwipeOffset(0)
      }
      setSwipeDirection(null)
    },
    onSwipedLeft: () => {
      if (Math.abs(swipeOffset) > 100) {
        handleDelete()
      } else {
        setSwipeOffset(0)
      }
      setSwipeDirection(null)
    },
    onTouchEndOrOnMouseUp: () => {
      if (Math.abs(swipeOffset) < 100) {
        setSwipeOffset(0)
        setSwipeDirection(null)
      }
    },
    delta: 30, // Minimum swipe distance to register
    preventScrollOnSwipe: true,
    trackMouse: false, // Desktop uses buttons, not swipe
  })

  // Background color based on swipe direction
  const getBgColor = () => {
    if (!swipeDirection) return ''
    if (swipeDirection === 'right') return 'bg-green-500'
    return 'bg-red-500'
  }

  // Icon based on swipe direction
  const getSwipeIcon = () => {
    if (!swipeDirection) return null
    if (swipeDirection === 'right') {
      return (
        <div className="absolute left-4 top-1/2 -translate-y-1/2 text-white">
          <svg className="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
          </svg>
        </div>
      )
    }
    return (
      <div className="absolute right-4 top-1/2 -translate-y-1/2 text-white">
        <svg className="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-7 7-7-7" />
        </svg>
      </div>
    )
  }

  return (
    <div className="relative overflow-hidden rounded-lg">
      {/* Background reveal */}
      <div className={`absolute inset-0 ${getBgColor()} transition-colors`}>
        {getSwipeIcon()}
      </div>

      {/* Card content */}
      <div
        {...handlers}
        style={{
          transform: `translateX(${swipeOffset}px)`,
          transition: swipeOffset === 0 ? 'transform 0.2s ease-out' : 'none',
        }}
        className={`relative touch-pan-y ${isProcessing ? 'opacity-50' : ''}`}
      >
        <TaskCard task={task} />
      </div>
    </div>
  )
}

```

Key implementation details:

- Only enable swipe on touch devices (trackMouse: false)
- Require 100px swipe to trigger action (prevents accidental swipes)
- Show green background with checkmark for complete (swipe right)
- Show red background with trash icon for delete (swipe left)
- Smooth transition back on cancelled swipe
- Confirmation dialog before delete

  </action>
  <verify>

- Package installed: `cat package.json | grep react-swipeable`
- File exists: `ls src/shared/components/SwipeableTaskCard.tsx`
- TypeScript compiles: `npx tsc --noEmit`

  </verify>
  <done>
SwipeableTaskCard component exists with react-swipeable for mobile swipe gestures (complete/delete)
  </done>
</task>

<task type="auto">
  <name>Task 2: Create mobile navigation and update layout</name>
  <files>
    src/shared/components/MobileNav.tsx
    src/app/(app)/layout.tsx
  </files>
  <action>

1. Create `MobileNav.tsx`:

```tsx
'use client'

import { useState } from 'react'
import Link from 'next/link'
import { usePathname } from 'next/navigation'

type MobileNavProps = {
  links: { href: string; label: string }[]
}

export function MobileNav({ links }: MobileNavProps) {
  const [isOpen, setIsOpen] = useState(false)
  const pathname = usePathname()

  return (
    <div className="md:hidden">
      {/* Hamburger button - 44x44px minimum touch target */}
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="p-2 min-w-[44px] min-h-[44px] flex items-center justify-center text-gray-600 dark:text-gray-400"
        aria-label="Toggle menu"
        aria-expanded={isOpen}
      >
        {isOpen ? (
          <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
          </svg>
        ) : (
          <svg className="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        )}
      </button>

      {/* Mobile menu overlay */}
      {isOpen && (
        <>
          {/* Backdrop */}
          <div
            className="fixed inset-0 bg-black/50 z-40"
            onClick={() => setIsOpen(false)}
          />

          {/* Menu */}
          <nav className="fixed top-16 left-0 right-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 z-50 shadow-lg">
            <div className="container mx-auto px-4 py-4 space-y-2">
              {links.map((link) => (
                <Link
                  key={link.href}
                  href={link.href}
                  onClick={() => setIsOpen(false)}
                  className={`
                    block px-4 py-3 rounded-lg text-base font-medium
                    min-h-[44px] flex items-center
                    ${pathname === link.href
                      ? 'bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400'
                      : 'text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700'
                    }
                  `}
                >
                  {link.label}
                </Link>
              ))}
            </div>
          </nav>
        </>
      )}
    </div>
  )
}

```

2. Update `src/app/(app)/layout.tsx`:
   - Add MobileNav component to header
   - Keep existing desktop nav with `hidden md:flex`
   - Ensure all interactive elements meet 44x44px minimum

```tsx
import Link from 'next/link'
import { redirect } from 'next/navigation'
import { auth, signOut } from '@/shared/lib/auth'
import { UserMenu } from '@/shared/components/UserMenu'
import { MobileNav } from '@/shared/components/MobileNav'

const navLinks = [
  { href: '/dashboard', label: 'Dashboard' },
  { href: '/tasks', label: 'Tasks' },
]

export default async function AppLayout({
  children,
}: {
  children: React.ReactNode
}) {
  const session = await auth()

  if (!session?.user) {
    redirect('/login')
  }

  async function handleSignOut() {
    'use server'
    await signOut({ redirectTo: '/' })
  }

  return (
    <div className="min-h-screen bg-gray-50 dark:bg-gray-900">
      <header className="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700">
        <div className="container mx-auto px-4 h-16 flex items-center justify-between">
          <div className="flex items-center gap-6">
            <Link href="/dashboard" className="text-xl font-bold text-gray-900 dark:text-white">
              Task Tracker
            </Link>

            {/* Desktop navigation */}
            <nav className="hidden md:flex items-center gap-4">
              {navLinks.map((link) => (
                <Link
                  key={link.href}
                  href={link.href}
                  className="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white px-2 py-2 min-h-[44px] flex items-center"
                >
                  {link.label}
                </Link>
              ))}
            </nav>
          </div>

          <div className="flex items-center gap-2">
            <UserMenu user={session.user} signOutAction={handleSignOut} />
            {/* Mobile navigation */}
            <MobileNav links={navLinks} />
          </div>
        </div>
      </header>

      <main className="container mx-auto px-4 py-8">
        {children}
      </main>
    </div>
  )
}

```

  </action>
  <verify>

- MobileNav exists: `ls src/shared/components/MobileNav.tsx`
- Layout updated: `grep MobileNav src/app/\(app\)/layout.tsx`
- Dev server shows hamburger on mobile: `npm run dev` and resize browser
- TypeScript compiles: `npx tsc --noEmit`

  </verify>
  <done>
Mobile navigation with hamburger menu implemented, layout updated with proper touch targets
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate SwipeableTaskCard into TaskList</name>
  <files>
    src/shared/components/TaskList.tsx
    src/shared/components/index.ts
  </files>
  <action>
Update TaskList to use SwipeableTaskCard on mobile devices:

1. Update `TaskList.tsx`:

```tsx
'use client'

import { useEffect, useState } from 'react'
import { TaskCard } from './TaskCard'
import { SwipeableTaskCard } from './SwipeableTaskCard'
import { EmptyState } from './EmptyState'

type Task = {
  id: string
  title: string
  description: string | null
  status: 'TODO' | 'IN_PROGRESS' | 'DONE'
  createdAt: Date
  updatedAt: Date
  tags?: { id: string; name: string; color: string | null }[]
  attachments?: { id: string }[]
}

type TaskListProps = {
  tasks: Task[]
}

type TaskSectionProps = {
  title: string
  tasks: Task[]
  status: Task['status']
  isMobile: boolean
}

function TaskSection({ title, tasks, status, isMobile }: TaskSectionProps) {
  const sectionTasks = tasks.filter((task) => task.status === status)

  return (
    <div>
      <h2 className="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">
        {title} ({sectionTasks.length})
      </h2>
      {sectionTasks.length === 0 ? (
        <p className="text-sm text-gray-500 dark:text-gray-400 italic">
          No tasks
        </p>
      ) : (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          {sectionTasks.map((task) =>
            isMobile ? (
              <SwipeableTaskCard key={task.id} task={task} />
            ) : (
              <TaskCard key={task.id} task={task} />
            )
          )}
        </div>
      )}
    </div>
  )
}

export function TaskList({ tasks }: TaskListProps) {
  const [isMobile, setIsMobile] = useState(false)

  // Detect mobile/touch device
  useEffect(() => {
    const checkMobile = () => {
      // Check for touch support and screen width
      const hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0
      const isNarrow = window.innerWidth < 768
      setIsMobile(hasTouch && isNarrow)
    }

    checkMobile()
    window.addEventListener('resize', checkMobile)
    return () => window.removeEventListener('resize', checkMobile)
  }, [])

  const isEmpty = tasks.length === 0

  if (isEmpty) {
    return (
      <EmptyState
        title="No tasks yet!"
        description="Create your first task to get started organizing your work."
        action={{ label: 'Create your first task', href: '/tasks/new' }}
      />
    )
  }

  return (
    <div className="space-y-8">
      {/* Swipe hint on mobile */}
      {isMobile && (
        <p className="text-sm text-gray-500 dark:text-gray-400 text-center">
          Swipe right to complete, left to delete
        </p>
      )}
      <TaskSection title="To Do" tasks={tasks} status="TODO" isMobile={isMobile} />
      <TaskSection title="In Progress" tasks={tasks} status="IN_PROGRESS" isMobile={isMobile} />
      <TaskSection title="Done" tasks={tasks} status="DONE" isMobile={isMobile} />
    </div>
  )
}

```

2. Update `src/shared/components/index.ts` to export new components:
   - Add export for SwipeableTaskCard
   - Add export for MobileNav

  </action>
  <verify>

- TaskList imports SwipeableTaskCard: `grep SwipeableTaskCard src/shared/components/TaskList.tsx`
- Components exported: `grep -E "SwipeableTaskCard|MobileNav" src/shared/components/index.ts`
- Test on mobile: Open dev server on phone or use browser DevTools mobile emulation
- TypeScript compiles: `npx tsc --noEmit`

  </verify>
  <done>
TaskList conditionally renders SwipeableTaskCard on mobile with touch support, showing swipe hint
  </done>
</task>

</tasks>

<verification>

1. Mobile navigation: Hamburger menu appears on small screens
2. Swipe gestures: Tasks can be swiped to complete/delete on mobile
3. Touch targets: All buttons/links meet 44x44px minimum
4. No scroll blocking: Regular scroll still works, only intentional swipes trigger actions
5. Build succeeds: `npm run build`

</verification>

<success_criteria>

- Mobile hamburger menu works correctly
- Swipe right completes task (green background with checkmark)
- Swipe left deletes task (red background, confirmation required)
- Swipe hint shown on mobile
- All touch targets at least 44x44px
- Desktop experience unchanged (no swipe, regular buttons)

</success_criteria>

<output>
After completion, create `.planning/phases/07-performance-quality/07-03-SUMMARY.md`
</output>
