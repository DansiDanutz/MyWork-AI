---
phase: 02-authentication-profiles
plan: 05
type: execute
wave: 4
depends_on: ["02-04"]
files_modified:
  - src/app/(app)/dashboard/page.tsx
autonomous: false

must_haves:
  truths:
    - "User can complete full OAuth flow: homepage -> login -> GitHub -> welcome"
    - "User can access dashboard after authentication"
    - "User can view and edit profile with auto-save"
    - "User can logout from any page and return to homepage"
    - "Session persists across page refreshes"
  artifacts:
    - path: "src/app/(app)/dashboard/page.tsx"
      provides: "Basic dashboard placeholder"
      min_lines: 15
  key_links:
    - from: "src/app/(app)/dashboard/page.tsx"
      to: "src/shared/lib/dal.ts"
      via: "getUser or verifySession"
      pattern: "import.*dal"
---

<objective>
Create dashboard placeholder and verify complete authentication flow end-to-end.

Purpose: Complete the authentication phase by adding the dashboard page (post-login destination) and running human verification of the entire OAuth flow.

Output: Dashboard page at /dashboard, verified working OAuth flow.
</objective>

<execution_context>
@/Users/dansidanutz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dansidanutz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-authentication-profiles/02-CONTEXT.md
@.planning/phases/02-authentication-profiles/02-RESEARCH.md

# All prior work
@src/shared/lib/auth.ts
@src/shared/lib/dal.ts
@src/app/(app)/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Dashboard Page</name>
  <files>src/app/(app)/dashboard/page.tsx</files>
  <action>
Create a basic dashboard page at src/app/(app)/dashboard/page.tsx:

```typescript
import { getUser } from '@/shared/lib/dal'

export default async function DashboardPage() {
  const user = await getUser()

  return (
    <div>
      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900 dark:text-white">
          Dashboard
        </h1>
        <p className="text-gray-600 dark:text-gray-400">
          Welcome back, {user?.name || 'there'}!
        </p>
      </div>

      {/* Placeholder content - will be replaced in Phase 3 */}
      <div className="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        <div className="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm">
          <h2 className="text-lg font-semibold text-gray-900 dark:text-white mb-2">
            Tasks
          </h2>
          <p className="text-3xl font-bold text-blue-600 dark:text-blue-400">
            0
          </p>
          <p className="text-sm text-gray-500 dark:text-gray-400">
            Total tasks
          </p>
        </div>

        <div className="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm">
          <h2 className="text-lg font-semibold text-gray-900 dark:text-white mb-2">
            In Progress
          </h2>
          <p className="text-3xl font-bold text-yellow-600 dark:text-yellow-400">
            0
          </p>
          <p className="text-sm text-gray-500 dark:text-gray-400">
            Tasks in progress
          </p>
        </div>

        <div className="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm">
          <h2 className="text-lg font-semibold text-gray-900 dark:text-white mb-2">
            Completed
          </h2>
          <p className="text-3xl font-bold text-green-600 dark:text-green-400">
            0
          </p>
          <p className="text-sm text-gray-500 dark:text-gray-400">
            Tasks completed
          </p>
        </div>
      </div>

      {/* Getting started section */}
      <div className="mt-8 p-6 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
        <h2 className="text-lg font-semibold text-blue-900 dark:text-blue-100 mb-2">
          Getting Started
        </h2>
        <p className="text-blue-700 dark:text-blue-300 mb-4">
          You&apos;re all set up! Task management features coming in Phase 3.
        </p>
        <div className="flex gap-4">
          <a
            href="/settings/profile"
            className="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors"
          >
            Complete your profile
          </a>
        </div>
      </div>
    </div>
  )
}
```

Create directory:
```bash
mkdir -p src/app/\(app\)/dashboard
```

This provides:
- Personalized greeting with user name
- Placeholder stats cards (will be populated in Phase 3)
- Getting started section with link to profile
- Uses getUser from DAL
  </action>
  <verify>
- File exists at src/app/(app)/dashboard/page.tsx
- `npm run build` succeeds
- Dashboard uses getUser from DAL
  </verify>
  <done>
Dashboard page created with placeholder content. Ready for task management features in Phase 3.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete authentication system with GitHub OAuth:
- Auth.js v5 with Prisma adapter
- Database schema with User, Account, Session models
- Login page with GitHub OAuth button
- Homepage with hero CTA
- Welcome/onboarding page
- Profile settings with auto-save
- User menu with logout
- Route protection middleware
- Dashboard placeholder
  </what-built>
  <how-to-verify>
**Prerequisites:** You need GitHub OAuth credentials set up.

1. **Set up GitHub OAuth App:**
   - Go to GitHub Settings -> Developer settings -> OAuth Apps -> New OAuth App
   - Homepage URL: http://localhost:3000
   - Authorization callback URL: http://localhost:3000/api/auth/callback/github
   - Copy Client ID and Client Secret

2. **Set environment variables:**
   Create or update `.env` file:
   ```
   AUTH_GITHUB_ID=your_client_id
   AUTH_GITHUB_SECRET=your_client_secret
   AUTH_SECRET=run_npx_auth_secret_to_generate
   DATABASE_URL=postgresql://dansidanutz@localhost:5432/tasktracker
   ```

   Generate AUTH_SECRET: `npx auth secret`

3. **Start the application:**
   ```bash
   npm run dev
   ```

4. **Test the full flow:**

   a. Visit http://localhost:3000
      - [ ] Homepage displays with "Login with GitHub" hero CTA
      - [ ] Navigation shows "Sign in" link

   b. Click "Login with GitHub"
      - [ ] Redirects to /login page
      - [ ] Login page shows GitHub OAuth button

   c. Click "Sign in with GitHub"
      - [ ] Redirects to GitHub OAuth consent screen
      - [ ] After approving, redirects to /welcome

   d. On /welcome page:
      - [ ] Shows your GitHub avatar and name
      - [ ] Displays onboarding steps
      - [ ] Has "Go to Dashboard" and "Set up your profile" buttons

   e. Click "Go to Dashboard"
      - [ ] Dashboard displays with personalized greeting
      - [ ] Header shows your avatar in user menu
      - [ ] Stats cards show (with 0 values)

   f. Click your avatar -> "Profile Settings"
      - [ ] Settings page with tabbed layout
      - [ ] Profile form shows your GitHub info
      - [ ] Edit Display Name field, wait 3 seconds
      - [ ] Status indicator shows "Saving..." then "Saved"

   g. Test logout:
      - [ ] Click avatar -> "Sign out"
      - [ ] Redirects to homepage
      - [ ] Hero CTA shows "Login with GitHub" again

   h. Test session persistence:
      - [ ] Login again
      - [ ] Close browser tab
      - [ ] Open new tab to http://localhost:3000/dashboard
      - [ ] Should still be logged in (within 24 hours)

   i. Test route protection:
      - [ ] Logout
      - [ ] Visit http://localhost:3000/settings/profile directly
      - [ ] Should redirect to /login with callbackUrl

5. **Verify error handling:**
   - Visit http://localhost:3000/login?error=OAuthCallback
   - [ ] Should show error message about sign in problem
  </how-to-verify>
  <resume-signal>
Type "approved" if all checks pass.
If issues found, describe them for gap closure.
  </resume-signal>
</task>

</tasks>

<verification>
After all tasks complete:

1. All authentication requirements verified:
   - AUTH-01: User can log in using GitHub OAuth
   - AUTH-02: User session persists across browser sessions (24h)
   - AUTH-03: User can log out from any page (user menu)
   - AUTH-04: User can recover access through GitHub (re-login)
   - AUTH-05: User can view and edit profile information
   - AUTH-06: User profile displays GitHub integration
   - INTG-04: User can view GitHub profile information in profile

2. Build verification:
   - Application builds without errors
   - All routes accessible with proper protection
</verification>

<success_criteria>
- [ ] Dashboard page exists at /dashboard
- [ ] Full OAuth flow works: homepage -> login -> GitHub -> welcome -> dashboard
- [ ] Profile auto-save works with status indicator
- [ ] Logout works from user menu
- [ ] Session persists across page refresh
- [ ] Protected routes redirect to login
- [ ] Error handling displays on login page
- [ ] Human verification approved
</success_criteria>

<output>
After completion, create `.planning/phases/02-authentication-profiles/02-05-SUMMARY.md`
</output>
