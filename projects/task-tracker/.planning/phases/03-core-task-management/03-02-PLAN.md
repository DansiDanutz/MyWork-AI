---
phase: 03-core-task-management
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/shared/components/TaskCard.tsx
  - src/shared/components/TaskList.tsx
  - src/shared/components/TaskForm.tsx
autonomous: true

must_haves:
  truths:
    - "TaskCard displays task info with status controls"
    - "TaskList groups tasks by status (Todo, In Progress, Done)"
    - "TaskForm handles task creation with validation feedback"
    - "Empty state shows when no tasks exist"
  artifacts:
    - path: "src/shared/components/TaskCard.tsx"
      provides: "Individual task display with actions"
      min_lines: 50
    - path: "src/shared/components/TaskList.tsx"
      provides: "Status-grouped task display"
      min_lines: 40
    - path: "src/shared/components/TaskForm.tsx"
      provides: "Task creation form"
      min_lines: 40
  key_links:
    - from: "src/shared/components/TaskCard.tsx"
      to: "src/app/actions/tasks.ts"
      via: "Server Action imports"
      pattern: "import.*from.*actions/tasks"
    - from: "src/shared/components/TaskForm.tsx"
      to: "src/app/actions/tasks.ts"
      via: "form action binding"
      pattern: "createTask"
---

<objective>
Build the core UI components for displaying and creating tasks.

Purpose: Create reusable components that will be used across task pages - TaskCard for individual tasks, TaskList for the grouped display, and TaskForm for creating new tasks.

Output: Three client components with optimistic UI, status management, and proper loading states.
</objective>

<execution_context>
@/Users/dansidanutz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dansidanutz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-core-task-management/03-CONTEXT.md
@.planning/phases/03-core-task-management/03-RESEARCH.md
@src/app/actions/tasks.ts
@src/shared/lib/dal.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TaskCard component with optimistic status updates</name>
  <files>src/shared/components/TaskCard.tsx</files>
  <action>
Create a client component for displaying individual tasks with status controls.

1. Create `src/shared/components/TaskCard.tsx`:

```typescript
'use client'

import { useOptimistic, useTransition } from 'react'
import { updateTaskStatus, deleteTask } from '@/app/actions/tasks'
import Link from 'next/link'
```

2. Define Task type (inline to avoid circular dependencies):
```typescript
type Task = {
  id: string
  title: string
  description: string | null
  status: 'todo' | 'in_progress' | 'done'
  createdAt: Date
  updatedAt: Date
}
```

3. Implement component with these features:

STATUS DROPDOWN with optimistic updates:
- Use useOptimistic hook for instant UI feedback
- Use useTransition for pending state
- Three options: "To Do", "In Progress", "Done"
- Visual indicator while saving (disabled state + opacity)

STATUS BADGES with color coding:
- todo: blue-100 text-blue-800
- in_progress: yellow-100 text-yellow-800
- done: green-100 text-green-800

CARD STYLING (per CONTEXT.md):
- White/dark background (bg-white dark:bg-gray-800)
- Shadow and rounded corners (shadow rounded-lg)
- Padding (p-4)
- Done tasks: slightly faded (opacity-75)

ACTIONS:
- Edit button: Link to /tasks/{id}/edit
- Delete button: confirm() dialog then call deleteTask
- Status dropdown: instant optimistic update

DATE DISPLAY:
- Show createdAt as relative time or formatted date
- Use Intl.DateTimeFormat for locale-aware formatting

4. Handle errors:
- If updateTaskStatus fails, useOptimistic automatically rolls back
- If deleteTask fails, show alert with error message

5. Loading states:
- Show "Saving..." indicator when isPending from useTransition
- Disable interactions during mutations
  </action>
  <verify>
File exists at src/shared/components/TaskCard.tsx
TypeScript compiles: `npx tsc --noEmit`
Component exports TaskCard function
  </verify>
  <done>TaskCard component displays task info with optimistic status updates and delete functionality</done>
</task>

<task type="auto">
  <name>Task 2: Create TaskList component with status grouping</name>
  <files>src/shared/components/TaskList.tsx</files>
  <action>
Create a component that displays tasks grouped by status.

1. Create `src/shared/components/TaskList.tsx`:

```typescript
'use client'

import { TaskCard } from './TaskCard'
```

2. Define props type:
```typescript
type Task = {
  id: string
  title: string
  description: string | null
  status: 'todo' | 'in_progress' | 'done'
  createdAt: Date
  updatedAt: Date
}

type TaskListProps = {
  tasks: Task[]
}
```

3. Implement status grouping (per CONTEXT.md):
- Three sections: "To Do", "In Progress", "Done"
- Each section shows count: "To Do (3)"
- Empty sections show "No tasks" message
- Use responsive grid: grid-cols-1 md:grid-cols-2 lg:grid-cols-3

4. Section styling:
- Section header: text-lg font-semibold mb-4
- Card grid with gap-4
- Section spacing: space-y-8 between sections

5. Empty section handling:
- Show subtle "No tasks" message for empty sections
- Don't hide empty sections (user should see structure)

6. Overall empty state (when ALL tasks empty):
- Center-aligned message
- "No tasks yet! Create your first task to get started"
- CTA button linking to /tasks/new
- Light gray/muted styling

7. Export both TaskList and a TaskSection helper component
  </action>
  <verify>
File exists at src/shared/components/TaskList.tsx
TypeScript compiles: `npx tsc --noEmit`
Component properly groups tasks by status
  </verify>
  <done>TaskList component displays tasks in status-grouped sections with empty state handling</done>
</task>

<task type="auto">
  <name>Task 3: Create TaskForm component for task creation</name>
  <files>src/shared/components/TaskForm.tsx</files>
  <action>
Create a form component for creating new tasks.

1. Create `src/shared/components/TaskForm.tsx`:

```typescript
'use client'

import { useActionState } from 'react'
import { createTask } from '@/app/actions/tasks'
```

2. Form fields (per CONTEXT.md - title required, description optional):
- Title: text input, required, max 200 chars
- Description: textarea, optional, max 2000 chars

3. Implement using useActionState for form state:
```typescript
const [state, formAction, pending] = useActionState(createTask, null)
```

4. Form styling:
- Labels: text-sm font-medium text-gray-700 dark:text-gray-300
- Inputs: Full width, border, rounded, focus ring
- Consistent padding and spacing
- Dark mode support

5. Validation feedback:
- Show error message if state.error exists
- Red border on invalid fields
- Error text below field: text-sm text-red-600

6. Submit button:
- Primary styling (bg-blue-600 text-white)
- Show "Creating..." when pending
- Disabled when pending

7. Cancel button:
- Secondary styling (border, gray text)
- Links back to /tasks

8. Form layout:
- Vertical stack (space-y-4)
- Max width (max-w-2xl) for readability
- Button row at bottom (flex gap-3)

Note: The form submits via Server Action which handles redirect. No client-side routing needed.
  </action>
  <verify>
File exists at src/shared/components/TaskForm.tsx
TypeScript compiles: `npx tsc --noEmit`
Form uses useActionState correctly
  </verify>
  <done>TaskForm component handles task creation with validation feedback and loading states</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. All component files exist:
   - src/shared/components/TaskCard.tsx
   - src/shared/components/TaskList.tsx
   - src/shared/components/TaskForm.tsx

2. TypeScript validation:
   - `npx tsc --noEmit` passes with no errors

3. Component features:
   - TaskCard has optimistic status updates via useOptimistic
   - TaskList groups tasks by status with empty states
   - TaskForm uses useActionState for Server Action integration

4. Styling consistency:
   - All components support dark mode
   - Consistent padding, shadows, rounded corners
</verification>

<success_criteria>
- TaskCard displays tasks with status controls and delete button
- TaskCard uses optimistic UI for instant status updates
- TaskList groups tasks by status (Todo, In Progress, Done)
- TaskList handles empty state with helpful message and CTA
- TaskForm creates tasks with validation feedback
- All components support dark mode and loading states
</success_criteria>

<output>
After completion, create `.planning/phases/03-core-task-management/03-02-SUMMARY.md`
</output>
