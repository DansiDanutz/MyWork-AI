---
phase: 03-core-task-management
plan: 04
type: execute
wave: 4
depends_on: ["03-03"]
files_modified:

  - src/app/(app)/tasks/[id]/edit/page.tsx
  - src/shared/components/TaskEditForm.tsx

autonomous: false

must_haves:
  truths:

```
- "User can edit existing tasks at /tasks/[id]/edit"
- "Task edit form pre-populates with current values"
- "User can update title, description, and status"
- "Invalid task ID shows not found state"

```
  artifacts:

```
- path: "src/app/(app)/tasks/[id]/edit/page.tsx"

  provides: "Task edit page with data fetching"
  min_lines: 30

- path: "src/shared/components/TaskEditForm.tsx"

  provides: "Edit form with update action"
  min_lines: 60

```
  key_links:

```
- from: "src/app/(app)/tasks/[id]/edit/page.tsx"

  to: "src/shared/lib/dal.ts"
  via: "getTask import"
  pattern: "getTask"

- from: "src/shared/components/TaskEditForm.tsx"

  to: "src/app/actions/tasks.ts"
  via: "updateTask import"
  pattern: "updateTask"

```
---

<objective>
Create the task edit page with full editing functionality.

Purpose: Allow users to edit existing tasks including title, description, and
status. This completes the CRUD operations for task management.

Output: Edit page at /tasks/[id]/edit with form pre-populated with current
values.
</objective>

<execution_context>
@/Users/dansidanutz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dansidanutz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-core-task-management/03-CONTEXT.md
@.planning/phases/03-core-task-management/03-RESEARCH.md
@src/app/actions/tasks.ts
@src/shared/lib/dal.ts
@src/shared/components/TaskForm.tsx
@src/shared/components/TaskCard.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TaskEditForm component</name>
  <files>src/shared/components/TaskEditForm.tsx</files>
  <action>
Create a form component for editing existing tasks. Similar to TaskForm but with
pre-populated values and status field.

1. Create `src/shared/components/TaskEditForm.tsx`:

```typescript

'use client'

import { useActionState, useTransition } from 'react'
import { useRouter } from 'next/navigation'
import Link from 'next/link'
import { updateTask, deleteTask } from '@/app/actions/tasks'

```yaml

2. Define props type:

```typescript

type Task = {
  id: string
  title: string
  description: string | null
  status: 'todo' | 'in_progress' | 'done'
}

type TaskEditFormProps = {
  task: Task
}

```

3. Form fields (all pre-populated):
- Title: text input, value={task.title}
- Description: textarea, value={task.description || ''}
- Status: select dropdown with three options

4. Form submission:
- Create a bound action that includes taskId:

```typescript

const updateTaskWithId = async (prevState: any, formData: FormData) => {
  return updateTask(task.id, formData)
}
const [state, formAction, pending] = useActionState(updateTaskWithId, null)

```yaml

5. Delete functionality:
- Separate delete button (red, destructive styling)
- Uses useTransition for pending state
- confirm() dialog before deleting
- On success, router.push('/tasks')

6. Form layout:
- Same styling as TaskForm for consistency
- Status field as select dropdown:
  - To Do (value="todo")
  - In Progress (value="in_progress")
  - Done (value="done")

7. Button row:
- "Save Changes" (primary, submits form)
- "Cancel" (secondary, links to /tasks)
- "Delete Task" (red/destructive, separate action)

8. Error handling:
- Show state.error if exists
- Field-level error highlighting

Note: Per CONTEXT.md, editing approach is at Claude's discretion. Using
dedicated page (consistent with /tasks/new pattern) rather than inline or modal
for simplicity.
  </action>
  <verify>
File exists at src/shared/components/TaskEditForm.tsx
TypeScript compiles: `npx tsc --noEmit`
Component accepts task prop and pre-populates fields
  </verify>
  <done>TaskEditForm component allows editing task title, description, and
  status with delete option</done>
</task>

<task type="auto">
  <name>Task 2: Create task edit page at /tasks/[id]/edit</name>
  <files>src/app/(app)/tasks/[id]/edit/page.tsx</files>
  <action>
Create a dynamic route page for editing tasks.

1. Create nested directories and file: `src/app/(app)/tasks/[id]/edit/page.tsx`

2. Implement as Server Component:

```typescript

import { notFound } from 'next/navigation'
import Link from 'next/link'
import { getTask } from '@/shared/lib/dal'
import { TaskEditForm } from '@/shared/components/TaskEditForm'

type Props = {
  params: Promise<{ id: string }>
}

export default async function EditTaskPage({ params }: Props) {
  const { id } = await params
  const task = await getTask(id)

  if (!task) {

```
notFound()

```
  }

  return (

```
// Page content

```
  )
}

```

3. Page structure:
- Header: "Edit Task" (text-2xl font-bold)
- Breadcrumb: "Tasks / Edit" or simple back link
- TaskEditForm component with task data

4. Not found handling:
- If getTask returns null (task doesn't exist or user doesn't own it)
- Call notFound() to show 404 page
- This is a security feature - users can't guess task IDs

5. Styling:
- Same max-width as create page (max-w-2xl)
- Consistent spacing
- Dark mode support

6. Next.js 15 note:
- params is now a Promise, must await it
- Use `Promise<{ id: string }>` type annotation

  </action>
  <verify>
Directory structure exists: src/app/(app)/tasks/[id]/edit/page.tsx
TypeScript compiles: `npx tsc --noEmit`
Invalid task ID shows 404
  </verify>
  <done>Edit task page fetches task data and renders TaskEditForm with
  pre-populated values</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete task management CRUD system:

- Task list page with status grouping
- Create task page with form
- Edit task page with form and delete
- Dashboard with real statistics
- Optimistic UI for status changes

  </what-built>
  <how-to-verify>

1. Start dev server: `npm run dev`
2. Navigate to <http://localhost:3000> and log in with GitHub
3. Go to Dashboard (/dashboard):
   - Verify task counts show "0" initially
   - Find and click "New Task" or "+" button

4. Create a task (/tasks/new):
   - Fill in title: "Test task"
   - Fill in description: "Testing the task tracker"
   - Submit the form
   - Verify redirect to /tasks

5. Task list (/tasks):
   - Verify task appears in "To Do" section
   - Verify card shows title, description, status dropdown

6. Change status:
   - Change status to "In Progress" via dropdown
   - Verify instant update (optimistic)
   - Refresh page - verify status persisted

7. Edit task:
   - Click "Edit" on the task card
   - Verify form pre-populated with current values
   - Change title to "Updated task"
   - Change status to "Done"
   - Save and verify changes

8. Delete task:
   - Go to edit page for a task
   - Click "Delete Task"
   - Confirm deletion
   - Verify redirect to /tasks
   - Verify task is gone

9. Dashboard check:
   - Go back to dashboard
   - Verify task counts reflect actual tasks

10. Empty state:
   - If all tasks deleted, verify /tasks shows friendly empty state

  </how-to-verify>
  <resume-signal>Type "approved" if all CRUD operations work correctly, or
  describe any issues found</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete:

1. Edit page functionality:
   - /tasks/[id]/edit loads with pre-populated data
   - Invalid ID shows 404
   - Form updates task correctly
   - Delete removes task

2. Full CRUD flow:
   - Create: /tasks/new -> creates task -> redirects to /tasks
   - Read: /tasks shows all tasks, grouped by status
   - Update: /tasks/[id]/edit -> updates task -> redirects to /tasks
   - Delete: Edit page delete -> removes task -> redirects to /tasks

3. Status management:
   - Status changes from TaskCard are instant (optimistic)
   - Status changes from edit form persist correctly

4. Navigation:
   - TaskCard "Edit" links to correct /tasks/[id]/edit
   - Cancel buttons return to /tasks
   - After create/update/delete, user sees updated task list

</verification>

<success_criteria>

- User can navigate to /tasks/[id]/edit from task card
- Edit form pre-populates with current task values
- User can update title, description, and status
- Delete button removes task with confirmation
- Invalid task ID shows 404 (security)
- All task CRUD operations verified by human testing

</success_criteria>

<output>
After completion, create
`.planning/phases/03-core-task-management/03-04-SUMMARY.md`
</output>
